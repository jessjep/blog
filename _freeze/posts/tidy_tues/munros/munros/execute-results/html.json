{
  "hash": "6d013c2d78f77bd910a1cc69b0787d36",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tidy Tuesday: Scotland's Munros\"\ndate: 2025-08-22\nexecute:\n  echo: true\n  warning: false\n  message: false\nimage: \"munros.png\"\ntags: \n  - tidytuesday\n---\n\n\n\nFor this week's Tidy Tuesday, I explored whether there are differences in Munro classification and height distribution depending on how they are named.\n\nAt this point I do feel a bit like a fraud in calling my submissions 'tidy' as the code certainly is not. Although I am working on tidying up my charts, so maybe it still counts.\n\n![](munros.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code\"}\ntuesdata <- tidytuesdayR::tt_load(2025, week = 33)\n\nscottish_munros <- tuesdata$scottish_munros\n\nlibrary(tidyverse)\nlibrary(ggridges)\nlibrary(patchwork)\n\nmunros <- scottish_munros %>%\n  mutate(Type = case_when(\n    str_detect(Name, \"Stob\") ~ \"Stob\",\n    str_detect(Name, \"Meall|Mheall|Mill|Mhill\") ~ \"Meall\",\n    str_detect(Name, \"Sgurr|Sgorr|Sgor\") ~ \"Sgùrr\",\n    str_detect(Name, \"Carn|Cairn|Chairn|Chuirn\") ~ \"Càrn\",\n    str_detect(Name, \"Ben|Beinn|Bheinn\") ~ \"Beinn\"),\n    Type = factor(Type, levels = c(\"Meall\", \"Creag\", \"Sgùrr\", \"Beinn\", \"Càrn\", \"Stob\"))\n    ) %>%\n  drop_na(Type) %>%\n  group_by(Type)\n\nmeans <- munros %>%\n  summarise(height = mean(Height_m),\n            number = n())\n\nbg <- \"#efe5dc\"\np <- ggplot(munros, aes(Height_m, Type, fill = Type)) +\n  geom_density_ridges(scale = 1.5, rel_min_height = 0.005,\n                      quantile_lines = TRUE, quantile_fun = mean,\n                      vline_linetype = \"dashed\",\n                      aes(color = \"Mean height (m)\")) +\n  scale_y_discrete(expand = c(0.01, 0)) +\n  scale_x_continuous(expand = c(0.01, 0)) +\n  scale_color_manual(name = NULL, values = c(\"Mean height (m)\" = \"black\")) +\n  scale_fill_brewer(palette = 9) +\n  labs(x = \"Height (m)\", y = NULL) +\n  guides(fill = \"none\",\n         color = guide_legend(override.aes=list(fill=bg))) +\n  theme(legend.key.width = unit(0.5, \"cm\"),\n        legend.key.height = unit(1, \"cm\"),\n        legend.position = \"inside\",\n        legend.position.inside = c(0.8,0.09))\n\n# combination\n\nmunros_long <- munros %>%\n  pivot_longer(7:17, names_to = \"Year\", values_to = \"Classification\") %>%\n  mutate(Year = as.integer(Year)) %>%\n  drop_na(Classification)\n\np3 <- ggplot(filter(munros_long, Year == 2021)) +\n  geom_bar(aes(x = Type, fill = Classification), colour = \"black\",\n           width = 0.5) +\n  labs(x = NULL, y = \"Number\") +\n  scale_fill_manual(values = tidyplots::colors_discrete_friendly_long) +\n  theme(axis.text.y = element_blank(),\n        legend.position = \"inside\",\n        legend.position.inside = c(0.85,0.8)) +\n  coord_flip()\n\ncombined_plot <- p + p3 & theme(plot.margin = margin(40,10,10,10),\n                                plot.background = element_rect(fill = bg, color = bg),\n                                panel.background = element_rect(fill = bg, color = bg),\n                                legend.background = element_rect(fill = bg, color = bg),\n                                panel.grid = element_blank(),\n                                axis.ticks = element_blank(),\n                                axis.text = element_text(size = 12),\n                                axis.title.x = element_text(size = 14, hjust = 1),\n                                plot.title = element_text(face = \"bold\", size = 16, hjust = 0, vjust = 5),\n                                plot.title.position = \"plot\") &\n  plot_annotation(title = \"Scotland's Munros and Munro Tops\",\n                  subtitle = glue::glue(\"A Munro is a Scottish mountain and a Munro Top is a subsidiary summit of a Munro not considered a distinct mountain in its own right.\n                  The charts below show the height distributions (in metres) and the number of Munros and Munro Tops by commonly used Gaelic names.\n                  The most common name used to describe a Munro is Beinn (or Ben), meaning 'mountain' or 'peak'.\"),\n                  caption = \"Created by jessimoore@bsky.social for #TidyTuesday. Source: The Database of British and Irish Hills v18.2, www.hills-database.co.uk\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}